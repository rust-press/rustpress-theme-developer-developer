{% extends "layouts/base.html" %}

{% block title %}{{ product.name }} | {{ site.name }}{% endblock %}
{% block description %}{{ product.short_description | striptags | truncate(length=160) }}{% endblock %}
{% block og_type %}product{% endblock %}
{% block og_image %}{{ product.image }}{% endblock %}

{% block body_class %}page-product{% endblock %}

{% block content %}
<div class="container">
  {# Breadcrumbs #}
  {% if theme.breadcrumbs.enabled | default(value=true) %}
  <nav class="breadcrumbs" aria-label="Breadcrumb">
    <a href="/">Home</a>
    <span class="separator">/</span>
    <a href="/shop">Shop</a>
    {% if product.category %}
    <span class="separator">/</span>
    <a href="{{ product.category.url }}">{{ product.category.name }}</a>
    {% endif %}
    <span class="separator">/</span>
    <span class="current">{{ product.name }}</span>
  </nav>
  {% endif %}

  {# Single Product #}
  <div class="single-product" itemscope itemtype="https://schema.org/Product">
    {# Product Gallery #}
    <div class="product-gallery">
      <div class="product-gallery-main">
        <img src="{{ product.image | default(value='/images/placeholder-product-large.jpg') }}" alt="{{ product.name }}" id="main-product-image" itemprop="image">
        {% if product.on_sale %}
        <span class="product-badge product-badge--sale">
          {% if product.discount_percent %}-{{ product.discount_percent }}%{% else %}Sale{% endif %}
        </span>
        {% endif %}
      </div>
      {% if product.gallery | length > 0 %}
      <div class="product-gallery-thumbs">
        <div class="product-gallery-thumb active" data-src="{{ product.image }}">
          <img src="{{ product.image }}" alt="{{ product.name }}">
        </div>
        {% for image in product.gallery %}
        <div class="product-gallery-thumb" data-src="{{ image }}">
          <img src="{{ image }}" alt="{{ product.name }}">
        </div>
        {% endfor %}
      </div>
      {% endif %}
    </div>

    {# Product Info #}
    <div class="product-info">
      <span class="product-category" itemprop="category">{{ product.category.name | default(value='Uncategorized') }}</span>

      <h1 class="product-title" itemprop="name">{{ product.name }}</h1>

      {# Rating #}
      <div class="product-rating" itemprop="aggregateRating" itemscope itemtype="https://schema.org/AggregateRating">
        <span class="stars">{% for i in range(end=product.rating | default(value=5) | int) %}★{% endfor %}{% for i in range(end=5 - (product.rating | default(value=5) | int)) %}☆{% endfor %}</span>
        <span class="rating-text">
          <span itemprop="ratingValue">{{ product.rating | default(value='4.5') }}</span> out of 5
          (<span itemprop="reviewCount">{{ product.reviews_count | default(value=0) }}</span> reviews)
        </span>
        <a href="#reviews" class="reviews-link">Read Reviews</a>
      </div>

      {# Price #}
      <div class="product-price" itemprop="offers" itemscope itemtype="https://schema.org/Offer">
        <meta itemprop="priceCurrency" content="USD">
        {% if product.sale_price %}
        <span class="current-price" itemprop="price" content="{{ product.sale_price }}">${{ product.sale_price }}</span>
        <span class="original-price">${{ product.price }}</span>
        <span class="discount-badge">Save ${{ (product.price - product.sale_price) | round(precision=2) }}</span>
        {% else %}
        <span class="current-price" itemprop="price" content="{{ product.price }}">${{ product.price }}</span>
        {% endif %}
        <link itemprop="availability" href="https://schema.org/{% if product.stock > 0 %}InStock{% else %}OutOfStock{% endif %}">
      </div>

      {# Short Description #}
      <div class="product-short-description" itemprop="description">
        {{ product.short_description | default(value='This is a sample product description. Add your product details here to inform customers about the features and benefits.') }}
      </div>

      {# Stock Status #}
      <div class="product-stock">
        {% if product.stock > 0 %}
        <span class="stock-badge stock-badge--in-stock">
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="20 6 9 17 4 12"></polyline></svg>
          In Stock
        </span>
        {% if product.stock < 10 %}
        <span class="stock-warning">Only {{ product.stock }} left!</span>
        {% endif %}
        {% else %}
        <span class="stock-badge stock-badge--out-of-stock">Out of Stock</span>
        {% endif %}
      </div>

      {# Product Options #}
      {% if product.options | length > 0 %}
      <div class="product-options">
        {% for option in product.options %}
        <div class="product-option">
          <label class="product-option-label">{{ option.name }}:</label>
          <div class="product-option-values">
            {% for value in option.values %}
            <button type="button" class="product-option-value {% if loop.first %}selected{% endif %}" data-option="{{ option.name }}" data-value="{{ value }}">
              {{ value }}
            </button>
            {% endfor %}
          </div>
        </div>
        {% endfor %}
      </div>
      {% else %}
      {# Sample options #}
      <div class="product-options">
        <div class="product-option">
          <label class="product-option-label">Size:</label>
          <div class="product-option-values">
            <button type="button" class="product-option-value selected">Small</button>
            <button type="button" class="product-option-value">Medium</button>
            <button type="button" class="product-option-value">Large</button>
            <button type="button" class="product-option-value">X-Large</button>
          </div>
        </div>
        <div class="product-option">
          <label class="product-option-label">Color:</label>
          <div class="product-option-values">
            <button type="button" class="product-option-value selected">Black</button>
            <button type="button" class="product-option-value">White</button>
            <button type="button" class="product-option-value">Navy</button>
          </div>
        </div>
      </div>
      {% endif %}

      {# Add to Cart #}
      <form class="product-add-to-cart" action="/api/cart/add" method="post">
        <input type="hidden" name="product_id" value="{{ product.id }}">

        <div class="product-quantity">
          <div class="quantity-selector">
            <button type="button" data-action="minus" aria-label="Decrease quantity">
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="5" y1="12" x2="19" y2="12"></line></svg>
            </button>
            <input type="number" name="quantity" value="1" min="1" max="{{ product.stock | default(value=99) }}" aria-label="Quantity">
            <button type="button" data-action="plus" aria-label="Increase quantity">
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="12" y1="5" x2="12" y2="19"></line><line x1="5" y1="12" x2="19" y2="12"></line></svg>
            </button>
          </div>

          <button type="submit" class="btn btn--primary btn--lg add-to-cart-btn" {% if product.stock == 0 %}disabled{% endif %}>
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="9" cy="21" r="1"></circle><circle cx="20" cy="21" r="1"></circle><path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"></path></svg>
            {% if product.stock > 0 %}Add to Cart{% else %}Sold Out{% endif %}
          </button>
        </div>
      </form>

      {# Secondary Actions #}
      <div class="product-actions-secondary">
        <button type="button" class="btn-wishlist" data-wishlist="{{ product.id }}">
          <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path></svg>
          Add to Wishlist
        </button>
        <button type="button" class="btn-compare" data-compare="{{ product.id }}">
          <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="17 1 21 5 17 9"></polyline><path d="M3 11V9a4 4 0 0 1 4-4h14"></path><polyline points="7 23 3 19 7 15"></polyline><path d="M21 13v2a4 4 0 0 1-4 4H3"></path></svg>
          Compare
        </button>
        <button type="button" class="btn-share" data-share>
          <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="18" cy="5" r="3"></circle><circle cx="6" cy="12" r="3"></circle><circle cx="18" cy="19" r="3"></circle><line x1="8.59" y1="13.51" x2="15.42" y2="17.49"></line><line x1="15.41" y1="6.51" x2="8.59" y2="10.49"></line></svg>
          Share
        </button>
      </div>

      {# Product Meta #}
      <div class="product-meta-info">
        <div class="product-meta-item">
          <span class="product-meta-label">SKU:</span>
          <span class="product-meta-value">{{ product.sku | default(value='N/A') }}</span>
        </div>
        {% if product.brand %}
        <div class="product-meta-item">
          <span class="product-meta-label">Brand:</span>
          <span class="product-meta-value">{{ product.brand }}</span>
        </div>
        {% endif %}
        <div class="product-meta-item">
          <span class="product-meta-label">Category:</span>
          <span class="product-meta-value">
            <a href="{{ product.category.url }}">{{ product.category.name | default(value='Uncategorized') }}</a>
          </span>
        </div>
        {% if product.tags | length > 0 %}
        <div class="product-meta-item">
          <span class="product-meta-label">Tags:</span>
          <span class="product-meta-value">
            {% for tag in product.tags %}
            <a href="/shop/tag/{{ tag.slug }}">{{ tag.name }}</a>{% if not loop.last %}, {% endif %}
            {% endfor %}
          </span>
        </div>
        {% endif %}
      </div>

      {# Trust Badges #}
      <div class="trust-badges">
        <div class="trust-badge">
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="1" y="3" width="15" height="13"></rect><polygon points="16 8 20 8 23 11 23 16 16 16 16 8"></polygon><circle cx="5.5" cy="18.5" r="2.5"></circle><circle cx="18.5" cy="18.5" r="2.5"></circle></svg>
          <span>Free Shipping</span>
        </div>
        <div class="trust-badge">
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"></path></svg>
          <span>Secure Payment</span>
        </div>
        <div class="trust-badge">
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="23 4 23 10 17 10"></polyline><polyline points="1 20 1 14 7 14"></polyline><path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"></path></svg>
          <span>30-Day Returns</span>
        </div>
      </div>
    </div>
  </div>

  {# Product Tabs #}
  <div class="product-tabs" data-tabs>
    <nav class="product-tabs-nav" role="tablist">
      <button type="button" role="tab" data-tab="description" class="active" aria-selected="true">Description</button>
      <button type="button" role="tab" data-tab="specifications">Specifications</button>
      <button type="button" role="tab" data-tab="reviews">Reviews ({{ product.reviews_count | default(value=12) }})</button>
      <button type="button" role="tab" data-tab="shipping">Shipping & Returns</button>
    </nav>

    {# Description Tab #}
    <div class="product-tab-content active" data-tab-panel="description" role="tabpanel">
      <div class="tab-content-inner">
        {{ product.description | default(value='<p>This is a detailed product description. Add comprehensive information about your product here, including features, benefits, and usage instructions.</p><p>You can include multiple paragraphs, lists, images, and any other content to help customers make informed purchasing decisions.</p>') | safe }}
      </div>
    </div>

    {# Specifications Tab #}
    <div class="product-tab-content" data-tab-panel="specifications" role="tabpanel">
      <table class="specs-table">
        <tbody>
          {% for spec in product.specifications %}
          <tr>
            <th>{{ spec.name }}</th>
            <td>{{ spec.value }}</td>
          </tr>
          {% else %}
          <tr><th>Weight</th><td>1.5 lbs</td></tr>
          <tr><th>Dimensions</th><td>10 x 8 x 2 inches</td></tr>
          <tr><th>Material</th><td>Premium Cotton Blend</td></tr>
          <tr><th>Care Instructions</th><td>Machine washable, tumble dry low</td></tr>
          <tr><th>Country of Origin</th><td>USA</td></tr>
          {% endfor %}
        </tbody>
      </table>
    </div>

    {# Reviews Tab #}
    <div class="product-tab-content" data-tab-panel="reviews" role="tabpanel" id="reviews">
      {# Review Summary #}
      <div class="reviews-summary">
        <div class="reviews-average">
          <span class="average-rating">{{ product.rating | default(value='4.5') }}</span>
          <div class="stars-large">★★★★☆</div>
          <span class="reviews-count">Based on {{ product.reviews_count | default(value=12) }} reviews</span>
        </div>
        <div class="rating-breakdown">
          {% for star in [5, 4, 3, 2, 1] %}
          <div class="rating-bar">
            <span class="rating-label">{{ star }} ★</span>
            <div class="rating-progress">
              <div class="rating-fill" style="width: {% if star == 5 %}65{% elif star == 4 %}20{% elif star == 3 %}10{% elif star == 2 %}3{% else %}2{% endif %}%"></div>
            </div>
            <span class="rating-count">{% if star == 5 %}8{% elif star == 4 %}2{% elif star == 3 %}1{% elif star == 2 %}1{% else %}0{% endif %}</span>
          </div>
          {% endfor %}
        </div>
        <button type="button" class="btn btn--primary" data-write-review>Write a Review</button>
      </div>

      {# Reviews List #}
      <div class="reviews-list">
        {% for review in product.reviews | slice(end=5) %}
        <div class="review">
          <div class="review-header">
            <div class="review-author">
              <img src="{{ review.author_avatar | default(value='/images/default-avatar.jpg') }}" alt="{{ review.author_name }}" class="review-avatar">
              <div>
                <span class="review-author-name">{{ review.author_name }}</span>
                {% if review.verified %}
                <span class="verified-badge">Verified Purchase</span>
                {% endif %}
              </div>
            </div>
            <div class="review-rating">
              {% for i in range(end=review.rating | int) %}★{% endfor %}{% for i in range(end=5 - (review.rating | int)) %}☆{% endfor %}
            </div>
          </div>
          <h4 class="review-title">{{ review.title }}</h4>
          <p class="review-content">{{ review.content }}</p>
          <div class="review-footer">
            <span class="review-date">{{ review.date | date(format='%B %d, %Y') }}</span>
            <div class="review-helpful">
              <span>Was this helpful?</span>
              <button type="button" data-helpful="{{ review.id }}">Yes ({{ review.helpful_count | default(value=0) }})</button>
            </div>
          </div>
        </div>
        {% else %}
        <div class="review">
          <div class="review-header">
            <div class="review-author">
              <img src="/images/default-avatar.jpg" alt="John D." class="review-avatar">
              <div>
                <span class="review-author-name">John D.</span>
                <span class="verified-badge">Verified Purchase</span>
              </div>
            </div>
            <div class="review-rating">★★★★★</div>
          </div>
          <h4 class="review-title">Excellent quality product!</h4>
          <p class="review-content">I'm very impressed with the quality of this product. It exceeded my expectations and arrived quickly. Would definitely recommend to others!</p>
          <div class="review-footer">
            <span class="review-date">January 10, 2024</span>
            <div class="review-helpful">
              <span>Was this helpful?</span>
              <button type="button">Yes (5)</button>
            </div>
          </div>
        </div>
        {% endfor %}
      </div>
    </div>

    {# Shipping Tab #}
    <div class="product-tab-content" data-tab-panel="shipping" role="tabpanel">
      <div class="shipping-info">
        <h3>Shipping Information</h3>
        <ul>
          <li>Free standard shipping on orders over $50</li>
          <li>Standard shipping: 5-7 business days ($5.99)</li>
          <li>Express shipping: 2-3 business days ($12.99)</li>
          <li>Next day delivery available for select areas ($19.99)</li>
        </ul>

        <h3>Return Policy</h3>
        <ul>
          <li>30-day return policy for unused items</li>
          <li>Items must be in original packaging</li>
          <li>Free returns for defective products</li>
          <li>Refunds processed within 5-7 business days</li>
        </ul>
      </div>
    </div>
  </div>

  {# Related Products #}
  {% if related_products | length > 0 %}
  <section class="related-products">
    <h2 class="section-title">You May Also Like</h2>
    <div class="products-grid products-grid--4-cols">
      {% for product in related_products | slice(end=4) %}
      <article class="product-card">
        <div class="product-image">
          <a href="{{ product.url }}">
            <img src="{{ product.image }}" alt="{{ product.name }}" loading="lazy">
          </a>
        </div>
        <div class="product-content">
          <h3 class="product-title">
            <a href="{{ product.url }}">{{ product.name }}</a>
          </h3>
          <div class="product-price">
            <span class="current-price">${{ product.price }}</span>
          </div>
        </div>
      </article>
      {% endfor %}
    </div>
  </section>
  {% endif %}
</div>
{% endblock %}

{% block scripts %}
<style>
/* Product Page Specific Styles */
.product-stock {
  display: flex;
  align-items: center;
  gap: var(--space-3);
  margin-bottom: var(--space-6);
}

.stock-badge {
  display: inline-flex;
  align-items: center;
  gap: var(--space-1);
  padding: var(--space-1) var(--space-3);
  font-size: var(--text-sm);
  font-weight: var(--font-medium);
  border-radius: var(--radius-full);
}

.stock-badge--in-stock {
  background-color: rgba(16, 185, 129, 0.1);
  color: var(--color-success);
}

.stock-badge--out-of-stock {
  background-color: rgba(239, 68, 68, 0.1);
  color: var(--color-error);
}

.stock-warning {
  font-size: var(--text-sm);
  color: var(--color-warning);
}

.discount-badge {
  padding: var(--space-1) var(--space-2);
  background-color: rgba(16, 185, 129, 0.1);
  color: var(--color-success);
  font-size: var(--text-sm);
  font-weight: var(--font-medium);
  border-radius: var(--radius-sm);
}

/* Rating Link */
.reviews-link {
  margin-left: var(--space-2);
  font-size: var(--text-sm);
  color: var(--color-primary);
}

/* Trust Badges */
.trust-badges {
  display: flex;
  gap: var(--space-4);
  margin-top: var(--space-6);
  padding-top: var(--space-6);
  border-top: 1px solid var(--border-color);
}

.trust-badge {
  display: flex;
  align-items: center;
  gap: var(--space-2);
  font-size: var(--text-sm);
  color: var(--text-secondary);
}

.trust-badge svg {
  color: var(--color-success);
}

/* Reviews */
.reviews-summary {
  display: grid;
  grid-template-columns: auto 1fr auto;
  gap: var(--space-8);
  padding: var(--space-6);
  background-color: var(--bg-secondary);
  border-radius: var(--radius-xl);
  margin-bottom: var(--space-8);
  align-items: center;
}

.reviews-average {
  text-align: center;
}

.average-rating {
  font-size: var(--text-5xl);
  font-weight: var(--font-bold);
  color: var(--text-primary);
}

.stars-large {
  font-size: var(--text-2xl);
  color: var(--color-warning);
}

.reviews-count {
  font-size: var(--text-sm);
  color: var(--text-secondary);
}

.rating-breakdown {
  display: flex;
  flex-direction: column;
  gap: var(--space-2);
}

.rating-bar {
  display: flex;
  align-items: center;
  gap: var(--space-3);
}

.rating-label {
  width: 40px;
  font-size: var(--text-sm);
  color: var(--text-secondary);
}

.rating-progress {
  flex: 1;
  height: 8px;
  background-color: var(--bg-tertiary);
  border-radius: var(--radius-full);
  overflow: hidden;
}

.rating-fill {
  height: 100%;
  background-color: var(--color-warning);
  border-radius: var(--radius-full);
}

.rating-count {
  width: 30px;
  font-size: var(--text-sm);
  color: var(--text-tertiary);
  text-align: right;
}

/* Reviews List */
.reviews-list {
  display: flex;
  flex-direction: column;
  gap: var(--space-6);
}

.review {
  padding: var(--space-6);
  background-color: var(--bg-secondary);
  border-radius: var(--radius-xl);
}

.review-header {
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
  margin-bottom: var(--space-3);
}

.review-author {
  display: flex;
  align-items: center;
  gap: var(--space-3);
}

.review-avatar {
  width: 48px;
  height: 48px;
  border-radius: var(--radius-full);
  object-fit: cover;
}

.review-author-name {
  font-weight: var(--font-semibold);
  display: block;
}

.verified-badge {
  font-size: var(--text-xs);
  color: var(--color-success);
}

.review-rating {
  color: var(--color-warning);
}

.review-title {
  font-size: var(--text-base);
  margin-bottom: var(--space-2);
}

.review-content {
  color: var(--text-secondary);
  margin-bottom: var(--space-3);
}

.review-footer {
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.review-date {
  font-size: var(--text-sm);
  color: var(--text-tertiary);
}

.review-helpful {
  display: flex;
  align-items: center;
  gap: var(--space-2);
  font-size: var(--text-sm);
  color: var(--text-secondary);
}

.review-helpful button {
  padding: var(--space-1) var(--space-2);
  background: none;
  border: 1px solid var(--border-color);
  border-radius: var(--radius-sm);
  font-size: var(--text-xs);
  cursor: pointer;
  transition: all var(--transition-fast);
}

.review-helpful button:hover {
  background-color: var(--bg-tertiary);
}

/* Specs Table */
.specs-table {
  width: 100%;
}

.specs-table th,
.specs-table td {
  padding: var(--space-3) var(--space-4);
  text-align: left;
  border-bottom: 1px solid var(--border-color);
}

.specs-table th {
  width: 200px;
  font-weight: var(--font-medium);
  background-color: var(--bg-secondary);
}

/* Shipping Info */
.shipping-info h3 {
  margin-top: var(--space-6);
  margin-bottom: var(--space-3);
}

.shipping-info h3:first-child {
  margin-top: 0;
}

.shipping-info ul {
  list-style: none;
  padding: 0;
}

.shipping-info li {
  padding: var(--space-2) 0;
  padding-left: var(--space-6);
  position: relative;
}

.shipping-info li::before {
  content: '✓';
  position: absolute;
  left: 0;
  color: var(--color-success);
}

/* Related Products */
.related-products {
  margin-top: var(--space-12);
  padding-top: var(--space-8);
  border-top: 1px solid var(--border-color);
}

.related-products .section-title {
  text-align: center;
  margin-bottom: var(--space-8);
}

.products-grid--4-cols {
  grid-template-columns: repeat(4, 1fr);
}

/* Responsive */
@media (max-width: 1024px) {
  .reviews-summary {
    grid-template-columns: 1fr;
    text-align: center;
  }

  .trust-badges {
    flex-wrap: wrap;
    justify-content: center;
  }

  .products-grid--4-cols {
    grid-template-columns: repeat(2, 1fr);
  }
}

@media (max-width: 768px) {
  .products-grid--4-cols {
    grid-template-columns: 1fr;
  }
}
</style>

<script>
// Product tabs
document.querySelectorAll('[data-tab]').forEach(tab => {
  tab.addEventListener('click', () => {
    const tabId = tab.dataset.tab;

    // Update tabs
    document.querySelectorAll('[data-tab]').forEach(t => {
      t.classList.remove('active');
      t.setAttribute('aria-selected', 'false');
    });
    tab.classList.add('active');
    tab.setAttribute('aria-selected', 'true');

    // Update panels
    document.querySelectorAll('[data-tab-panel]').forEach(panel => {
      panel.classList.toggle('active', panel.dataset.tabPanel === tabId);
    });
  });
});

// Product option selection
document.querySelectorAll('.product-option-value').forEach(btn => {
  btn.addEventListener('click', () => {
    const optionGroup = btn.closest('.product-option');
    optionGroup.querySelectorAll('.product-option-value').forEach(b => b.classList.remove('selected'));
    btn.classList.add('selected');
  });
});

// Product gallery thumbs
document.querySelectorAll('.product-gallery-thumb').forEach(thumb => {
  thumb.addEventListener('click', () => {
    const newSrc = thumb.dataset.src;
    document.getElementById('main-product-image').src = newSrc;

    document.querySelectorAll('.product-gallery-thumb').forEach(t => t.classList.remove('active'));
    thumb.classList.add('active');
  });
});
</script>
{% endblock %}
